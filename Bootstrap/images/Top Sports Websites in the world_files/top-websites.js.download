!function(t){t.fn.swCreateId=function(){return this.each(function(){var e=t(this);if(!e.attr("id")){var n=Sw.Helpers.String.getRandomId();e.attr("id",n)}})},t.fn.swPasswordStrength=function(){return this.each(function(){var e=t(this),n=e.find('input[type="password"]').first(),i=["Very Weak","Weak","Better","Medium","Strong","Strongest"];n.keydown(function(t){var a=n.val(),r=0;a.length>6&&r++,a.match(/[a-z]/)&&a.match(/[A-Z]/)&&r++,a.match(/\d+/)&&r++,a.match(/.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/)&&r++,a.length>12&&r++,e.find(".password-description").text(i[r]),e.find(".password-strength").attr("class","password-strength strength"+r)})})},t.fn.swScrollPaging=function(e){return this.each(function(){var n=t(this),i=n.children().first();n.scroll(function(t){n.scrollTop()+n.height()>=i.height()&&e()})})},t.fn.swSharedCount=function(e,n,i){var a=e.split(".").length<=2?"www."+e:e,r=this,o=App.Helpers.Links.getDomainLink(a);return t.sharedCount(o,function(e){var a="string"==typeof e?t.parseJSON(e):e,o={"facebook-likes":a.Facebook.like_count,"facebook-shares":a.Facebook.share_count,twitter:a.Twitter,linkedin:a.LinkedIn,googleplus:a.GooglePlusOne,stumbleupon:a.StumbleUpon,delicious:a.Delicious};t.each(o,function(t,e){var i="."+t+" ",a=App.Helpers.StringHelper.numberWithCommas(e);n?i=i+" "+n:i+=" .number",r.find(i).data("stat",e).text(a)}),i&&i()})},t.QueryParam=function(t,e){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n="[\\?&]"+t+"=([^&#]*)",i=new RegExp(n),a=i.exec(window.location.search);return null==a?e||"":decodeURIComponent(a[1].replace(/\+/g," "))},t.fn.slideGallery=function(e){var n,i,a,r,o,s,c,h=t.extend({prev:t(),next:t(),animationSpeed:300,show:1,slideWhenOver:20,jumpEach:1},e),u=0;n=this,i=this.children(),a=i.length,r=i.width(),o=r*a,c=o-Math.min(a,h.show)*r,s=function(){u>c+.01?(u=c,n.animate({right:Math.round(u+h.slideWhenOver)+"px"},h.animationSpeed,function(){n.animate({right:Math.round(u)+"px"},h.animationSpeed)})):u<-.01?(u=0,n.animate({right:Math.round(u-h.slideWhenOver)+"px"},h.animationSpeed,function(){n.animate({right:Math.round(u)+"px"},h.animationSpeed)})):n.animate({right:Math.round(u)+"px"},h.animationSpeed)},h.prev.click(function(t){u-=r*h.jumpEach,s(),t.preventDefault()}),h.next.click(function(t){u+=r*h.jumpEach,s(),t.preventDefault()})},t.fn.fadeOutText=function(t,e){var n={INPUT:{before:function(t,e,n){t.addClass("hidden-placeholder"),navigator.userAgent.indexOf("Chrome")<0&&this.after(t,e,n)},after:function(t,e,n){t.attr("placeholder",e),t.removeClass("hidden-placeholder")}},"*":{before:function(t,e,n){var i="opacity "+n+"ms";t.css({transition:i,webkitTransition:i,MozTransition:i,msTransition:i,opacity:0})},after:function(t,e,n){e&&t.html(e),t.css("opacity",1)}}},i=n[this.prop("tagName").toUpperCase()]||n["*"];this.one("transitionend webkitTransitionEnd",function(n){i.after(this,t,e)}),i.before(this,t,e)}}(jQuery);
function validateInputs(e,r){var r=r||!1,a=this,n=!0,t=/\S+@\S+\.\S+/;return $.each(e,function(e,i){var s=t.test(i.value);return i.value?"email"!==i.type||s?void 0:(r||a.appendErrorMessage("Enter a valid email"),n=!1):(r||a.appendErrorMessage(i.name+" is required"),n=!1)}),n}function appendErrorMessage(e){$(".form-error").html(e)}
SwModule.Mixins.BlinkGoBtn={events:{"change.blinkGoBtn .js-customSelect":"blinkGoButton"},defaults:{timeForBlink:600,btnGoSelector:".js-go",btnGoHoverState:"is-hovered"},blinkGoButton:function(){var t=$(this.defaults.btnGoSelector);t.addClass(this.defaults.btnGoHoverState),_.delay(t.removeClass.bind(t,this.defaults.btnGoHoverState),this.defaults.timeForBlink)}};
SwModule.Views.WebsiteTooltip=Backbone.View.extend({className:"websiteTooltip js-tooltip",defaults:{directionLeftClass:"websiteTooltip--directionLeft",directionRightClass:"websiteTooltip--directionRight"},website:null,tooltipClass:"",tooltipLifeTimeMs:2500,tooltipLifeTimeOut:null,tooltipWidth:375,initialize:function(t){var i=this;this.$target=$(t.evt.currentTarget),this.website=this.$target.data("shorturl"),this.body=$("body");this.tooltipLifeTimeOut=setTimeout(function(){i.remove()},this.tooltipLifeTimeMs)},getWebsite:function(){return this.website},preRender:function(){var t,i,e;this.$el.html(Tpl.website_list_tooltip_template({loading:!0})),t=this.getTooltipDirection(this.$target),i=t===this.defaults.directionLeftClass,this.tooltipClass=this.$target.data("tooltip-class")?this.$target.data("tooltip-class"):"",e={left:this.getTooltipLeft(this.$target,i),top:this.$target.offset().top+this.$target.height()},this.$el.css(e).addClass(t).addClass(this.tooltipClass)},renderTemplate:function(t){this.$el.html(t),this.body.append(this.$el)},renderNoData:function(){this.$el.html(Tpl.website_list_tooltip_template({noData:!0})),this.body.append(this.$el)},removeTooltip:function(){clearTimeout(this.tooltipLifeTimeOut),this.request&&this.request.abort(),this.$el.remove()},getTooltipDirection:function(t){return $(window).width()-t.offset().left+$(window).scrollLeft()-t.outerWidth()<this.tooltipWidth?this.defaults.directionLeftClass:this.defaults.directionRightClass},getTooltipLeft:function(t,i){var e=t.width();return i&&(e=-this.tooltipWidth-70),t.offset().left+e}});
SwModule.Models.Tooltips=Backbone.Model.extend({template:""}),SwModule.Models.CachedTooltips=Backbone.Collection.extend({model:SwModule.Models.Tooltips}),SwModule.Mixins.WebsiteTooltip={events:{"mouseenter.WebsiteTooltip .js-tooltipTarget":_.debounce(function(e){this.showTooltip(e)},150),"mouseleave.WebsiteTooltip .js-tooltipTarget":"removeTooltip","mouseleave.WebsiteTooltip .js-tooltip":"removeTooltip"},cachedTooltips:{},initTooltips:function(){this.cachedTooltips=new SwModule.Models.CachedTooltips},showTooltip:function(e){var o=this;this.tooltip&&this.removeTooltip(),this.tooltip=new SwModule.Views.WebsiteTooltip({evt:e});var t=this.tooltip.getWebsite(),i=t.replace(".","_");if(this.cachedTooltips.get(i)){var l=this.cachedTooltips.get(i);this.tooltip.preRender(),this.tooltip.renderTemplate(l.get("template"))}else this.tooltip.preRender(),this.request=$.ajax({url:"/siteinfo",method:"POST",data:{shorturl:t},success:function(e){if(e){var t=new SwModule.Models.Tooltips({id:i});t.set({template:e}),o.cachedTooltips.add(t),o.tooltip.renderTemplate(t.get("template"))}else o.tooltip.renderNoData()}})},removeTooltip:function(){this.tooltip&&(this.tooltip.removeTooltip(),this.tooltip.remove())}};
SwModule.Views.FixedTooltipView=Backbone.View.extend({defaults:{tooltipOwner:"js-tooltipOwner",tooltipContainer:"js-tooltipContainer",tooltipBody:"js-tooltipBody",classShow:"is-shown",tooltipCounter:0,attributeAllowHover:"tooltip-allow-hover",tooltipOrientation:"bottomleft"},regex:{orientation:/^(top|right|bottom|left)(top|right|bottom|left|middle|center)$/},tooltip:{orientation:{},position:{},size:{}},owner:{position:{},size:{}},initialize:function(){$("body").on("mouseover",".js-tooltipOwner",this.handleMouseover.bind(this)).on("mouseleave",".js-tooltipOwner",this.handleMouseleave.bind(this)).on("mouseover",".js-tooltipBody",this.handleMouseoverTooltip.bind(this)).on("mouseleave",".js-tooltipBody",this.hideTooltip.bind(this))},handleMouseover:function(t){var i=$(t.currentTarget);this.tooltipId=this.getTooltipId(i),this.checkTooltipHover(i),this.showTooltip(i),this.addScrollEventListener()},handleMouseoverTooltip:function(){void 0!==this.hideTooltipTrigger&&clearTimeout(this.hideTooltipTrigger)},handleMouseleave:function(){if(this.allowTooltipHover)return void(this.hideTooltipTrigger=setTimeout(function(){this.hideTooltip()}.bind(this),200));this.hideTooltip()},hideTooltip:function(){this.removeScrollEventListener(),$("."+this.defaults.tooltipContainer+"."+this.defaults.classShow).removeClass(this.defaults.classShow),this.tooltipId="",this.allowTooltipHover=!1},showTooltip:function(t){var i,o=$("."+this.defaults.tooltipContainer+"[data-id="+this.tooltipId+"]");o.length&&(this.setOwnerDimensions(t),this.setTooltipSize(o),this.setTooltipOrientation(o),this.checkTooltipOrientation(o),i=this.getTooltipPosition(),o.css({left:i.left,top:i.top}).addClass(this.defaults.classShow))},checkTooltipOrientation:function(t){var i=this.getAvailableSpace();switch(this.tooltip.orientation.side){case"left":case"right":i[this.tooltip.orientation.side].width<this.tooltip.size.width&&this.changeOrientation(t);break;case"top":case"bottom":i[this.tooltip.orientation.side].height<this.tooltip.size.height&&this.changeOrientation(t)}},splitToOrientation:function(t){return t.toLowerCase().match(this.regex.orientation)},setTooltipSize:function(t){this.tooltip.size={width:t.outerWidth(),height:t.find("."+this.defaults.tooltipBody).outerHeight()}},setTooltipOrientation:function(t){var i,o,e=t.attr("class").toLowerCase().split(" ");for(o=0;o<e.length&&!(i=this.splitToOrientation(e[o]));o++);i||(i=this.splitToOrientation(this.defaults.tooltipOrientation),t.addClass(i[0])),this.tooltip.orientation={fullName:i[0],side:i[1],align:i[2]}},flipTooltipOrientation:function(t){var i={top:"bottom",bottom:"top",left:"right",right:"left"},o=this.splitToOrientation(i[t.side]+t.align);return{fullName:o[0],side:o[1],align:o[2]}},changeOrientation:function(t){var i=this.tooltip.orientation.fullName,o=this.flipTooltipOrientation(this.tooltip.orientation),e=o.fullName;t.removeClass(i).addClass(e),this.tooltip.orientation={fullName:o[0],side:o[1],align:o[2]}},setOwnerDimensions:function(t){this.owner.size={width:t.outerWidth(),height:t.outerHeight()},this.owner.position={top:t.offset().top-$(window).scrollTop(),left:t.offset().left-$(window).scrollLeft()},this.owner.position.bottom=this.owner.position.top+this.owner.size.height,this.owner.position.right=this.owner.position.left+this.owner.size.width},getAvailableSpace:function(){var t=$(window).width(),i=$(window).height();return{top:{width:t,height:this.owner.position.top},left:{width:this.owner.position.left,height:i},bottom:{width:t,height:i-this.owner.position.bottom},right:{width:t-this.owner.position.right,height:i}}},getTooltipPosition:function(){var t=Math.round(this.owner.size.height/2),i=Math.round(this.owner.size.width/2),o=Math.round(this.tooltip.size.height/2),e=Math.round(this.tooltip.size.width/2),s={};switch(this.tooltip.orientation.side){case"top":s.top=this.owner.position.top-this.tooltip.size.height;break;case"bottom":s.top=this.owner.position.bottom;break;case"left":s.left=this.owner.position.left-this.tooltip.size.width;break;case"right":s.left=this.owner.position.right}switch(this.tooltip.orientation.align){case"top":s.top=this.owner.position.top;break;case"bottom":s.bottom=this.owner.position.bottom-this.tooltip.size.height;break;case"middle":s.top=this.owner.position.top+t-o;break;case"left":s.left=this.owner.position.left;break;case"right":s.left=this.owner.position.right-this.tooltip.size.width;break;case"center":s.left=this.owner.position.left+i-e}return s},addScrollEventListener:function(){window.addEventListener("scroll",this.hideTooltip.bind(this),!1)},removeScrollEventListener:function(){window.removeEventListener("scroll",this.hideTooltip,!1)},getTooltipId:function(t){var i=t.attr("data-source");return i||(i="tooltip"+this.defaults.tooltipCounter,t.attr("data-source",i).find("."+this.defaults.tooltipContainer).attr("data-id",i).appendTo("body"),this.defaults.tooltipCounter++),i},checkTooltipHover:function(t){this.allowTooltipHover=!!t.data(this.defaults.attributeAllowHover)}});
SwModule.Mixins.SocialShareTrackingMixin=function(){return{bindSocialButtonsTracking:function(n){function o(){sw.tracker.trackEvent(n,"click","Page/"+t)}var t;this.$(this.defaults.socialButtons).on("mouseleave",function(){$(window).off("blur",o)}),this.$(this.defaults.facebookContainerSelector).on("mouseenter",function(){t="Facebook",$(window).focus(),$(window).on("blur",o)}),this.$(this.defaults.twitterContainerSelector).on("mouseenter",function(){t="Twitter",$(window).focus(),$(window).on("blur",o)})}}}();
SwModule.Views.TopWebsitesView=Backbone.View.extend({constructor:function(){Backbone.View.prototype.constructor.apply(this,arguments)},events:{"click .js-go":"search"},defaults:{category:"all",country:"worldwide",root:"/top-websites",facebookContainerSelector:".js-shareFacebook",twitterContainerSelector:".js-shareTwitter",socialButtons:".js-shareSocial"},initialize:function(){$.extend(!0,this,SwModule.Mixins.BlinkGoBtn),$.extend(!0,this,SwModule.Mixins.WebsiteTooltip),$.extend(!0,this,SwModule.Mixins.SocialShareTrackingMixin),this.bindSocialButtonsTracking("Website Rankings"),this.initTooltips()},search:function(){window.location.href=this.getSearchUrl()},getSearchUrl:function(){var t,e,i=this.captureFiltersData();return t=i.country===this.defaults.country?"":"/"+i.country,e=i.category===this.defaults.category?"":"/category/"+i.category.replace(/_/g,"-"),this.defaults.root+t+e},captureFiltersData:function(){return _.reduce(this.$(".js-selectParent .js-customSelect"),function(t,e){return t[$(e).data("subject")]=$(e).val().toLowerCase(),t},{},this)},remove:function(){this.removeTooltip()}});